class Timer{constructor(t,e,s,i,n,o){this.reserverElt=t,this.nomStationElt=e,this.nomUtilisateurElt=s,this.reserverCanvasElt=i,this.dernierTempsElt=n,this.actualisationPageWeb,this.minutes=o,this.secondes=0,this.tempsReservation=o,this.compteur=0,this.chrono="",this.nomStation="",this.nom="",this.prenom="",this.ajax=new Ajax}initialisationTimer(){this.actualisationPageWeb=0,this.actualisation(),this.reserverElt.addEventListener("click",this.validationReservation.bind(this))}validationReservation(){this.nom=document.getElementById("nom").value,this.prenom=document.getElementById("prenom").value,sessionStorage.setItem("nom",this.nom),sessionStorage.setItem("prenom",this.prenom),this.reserverCanvasElt.style.display="none",(this.actualisationPageWeb>0||this.compteur>0)&&(this.actualisationPageWeb=0,this.minutes=this.tempsReservation,this.secondes=0,clearInterval(this.chrono)),this.dataJcdecaux(),this.compteur++}actualisation(){"oui"===sessionStorage.getItem("actualiser")&&(this.nomStation=sessionStorage.getItem("nomStation"),this.nom=sessionStorage.getItem("nom"),this.prenom=sessionStorage.getItem("prenom"),this.minutes=sessionStorage.getItem("minutes"),this.secondes=sessionStorage.getItem("secondes"),this.chrono=setInterval(this.diminuerCompteur.bind(this),1e3),this.actualisationPageWeb++)}dataJcdecaux(){this.ajax.get("https://api.jcdecaux.com/vls/v1/stations?contract=Lyon&apiKey=d9ce4a4ff8aee76cf49b9b8394047ea940b54c4d",function(t){let e=JSON.parse(t),s=sessionStorage.getItem("latitudeLongitude");for(let t in e)s===JSON.stringify(e[t].position)&&(this.nomStation=e[t].name,this.nomStation=this.nomStation.split("-"),this.nomStation=this.nomStation[1],sessionStorage.setItem("nomStation",this.nomStation));this.chrono=setInterval(this.diminuerCompteur.bind(this),1e3)}.bind(this))}diminuerCompteur(){0===this.secondes&0===this.minutes?this.finDuCompteArebours():0===this.secondes?this.miseAjourDesMinutesEtDesSecondes(""):this.miseAjourDesSecondes("")}finDuCompteArebours(){this.nomStationElt.textContent="",this.nomUtilisateurElt.textContent="",this.dernierTempsElt.textContent="",clearInterval(this.chrono),sessionStorage.setItem("actualiser","non")}miseAjourDesMinutesEtDesSecondes(t){this.minutes=this.minutes-1,this.secondes=59,this.miseAjourSessionStorage(),t=this.minutes+" min "+this.secondes+"s",this.miseAjourDuDom(t)}miseAjourDesSecondes(t){this.secondes=this.secondes-1,this.miseAjourSessionStorage(),t=this.minutes+" min "+this.secondes+"s",this.miseAjourDuDom(t)}miseAjourSessionStorage(){sessionStorage.setItem("actualiser","oui"),sessionStorage.setItem("secondes",this.secondes),sessionStorage.setItem("minutes",this.minutes)}miseAjourDuDom(t){this.nomStationElt.textContent=this.nomStation,this.nomUtilisateurElt.textContent=this.prenom+" "+this.nom,this.dernierTempsElt.textContent=t}}