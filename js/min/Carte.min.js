class Carte{constructor(t,i,e,s,o,a,n,l,r,h,c,p){this.iconBaseVert=t,this.iconBaseRouge=i,this.iconBaseBleu=e,this.adresseElt=s,this.placesTotalElt=o,this.veloDispoElt=a,this.formulaireReservationElt=n,this.infoStationElt=l,this.inputNomElt=c,this.inputPrenomElt=p,this.stationFermmeeElt=r,this.reservationImpossibleElt=h,this.iconChoisie="",this.latitudeLongitude="",this.latitudeMarker="",this.adresse="",this.place="",this.veloDispo="",this.ajax=new Ajax,this.carteLyon}initilisationDeLaCarte(){this.ajax.get("https://api.jcdecaux.com/vls/v1/stations?contract=Lyon&apiKey=d9ce4a4ff8aee76cf49b9b8394047ea940b54c4d",function(t){let i=JSON.parse(t);this.creationDeLaCarte();for(let t in i){"OPEN"===i[t].status&&0===i[t].available_bikes?this.iconChoisie=this.iconBaseBleu:"OPEN"===i[t].status?this.iconChoisie=this.iconBaseVert:this.iconChoisie=this.iconBaseRouge;let s=L.icon({iconUrl:this.iconChoisie,iconSize:[39,42],iconAnchor:[25,50],popupAnchor:[-3,-76]});L.marker([i[t].position.lat,i[t].position.lng],{icon:s}).addTo(this.carteLyon).on("click",e.bind(this))}function e(t){this.latitudeLongitude=JSON.stringify(t.latlng),sessionStorage.setItem("latitudeLongitude",this.latitudeLongitude),this.latitudeMarker=this.latitudeLongitude.split(","),this.latitudeMarker=this.latitudeMarker[0].split(":");for(let t in i)this.latitudeMarker[1]===JSON.stringify(i[t].position.lat)&&("OPEN"===i[t].status&&0===i[t].available_bikes?this.miseAjourDomInfoStation("","","","La station est ouverte mais aucun vélo n'est disponible"):"OPEN"===i[t].status?(this.adresse=i[t].address,this.place=i[t].bike_stands,this.veloDispo=" "+i[t].available_bikes,this.miseAjourDomInfoStation(this.adresse,this.place,this.veloDispo),this.affichageDuDernierPrenomEtNomTapePartUtilisateur()):this.miseAjourDomInfoStation("","","","La station est fermée. Sélectionner une autre station"))}}.bind(this))}creationDeLaCarte(){this.carteLyon=L.map("maps").setView([45.75,4.85],14),L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiamVyb21lNDVkd2pwMyIsImEiOiJja2w5dWpxYXkwcjV3MnJuMDJhcHJrcGF2In0.EOImOSC9SzgDUCy6OuxuQQ"}).addTo(this.carteLyon)}affichageDuDernierPrenomEtNomTapePartUtilisateur(){this.inputPrenomElt.value=localStorage.getItem("Prenom"),this.inputNomElt.value=localStorage.getItem("Nom")}miseAjourDomInfoStation(t,i,e,s){e.length>0?(this.infoStationElt.style.display="block",this.stationFermmeeElt.style.display="none",this.adresseElt.textContent=t,this.placesTotalElt.textContent=i,this.veloDispoElt.textContent=e,this.reservationImpossibleElt.textContent=""):(this.stationFermmeeElt.style.display="block",this.infoStationElt.style.display="none",this.adresseElt.textContent="",this.placesTotalElt.textContent="",this.veloDispoElt.textContent="",this.reservationImpossibleElt.textContent=s)}}